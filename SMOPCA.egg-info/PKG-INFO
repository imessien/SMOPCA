Metadata-Version: 2.4
Name: SMOPCA
Version: 0.1.2
Summary: A novel spatially aware multi-omics dimension reduction method
Home-page: https://github.com/cmhimself/SMOPCA
Author: Mo Chen
Author-email: mochen@smail.nju.edu.cn
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.10.0
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: anndata>=0.8.0
Requires-Dist: h5py>=3.8.0
Requires-Dist: matplotlib>=3.6.3
Requires-Dist: numpy>=1.23.5
Requires-Dist: pandas>=1.5.3
Requires-Dist: scanpy>=1.9.1
Requires-Dist: scikit-learn>=1.2.1
Requires-Dist: scipy>=1.15.3
Requires-Dist: seaborn>=0.11.0
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license-file
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# Spatial Multi-Omics PCA

Spatial Multi-Omics PCA (SMOPCA) is a novel dimension reduction method to integrate multi-modal data and extract low-dimensional representations with preserved spatial dependencies among spots.

![fig1](./img/fig1.png)

## Installation

SMOPCA can be installed directly from PyPI using the following command:
```
pip install SMOPCA
```

### Dependencies

SMOPCA requires the following dependencies:
- Python >= 3.10
- scipy >= 1.15.3
- numpy >= 1.23.5
- pandas >= 1.5.3
- matplotlib >= 3.6.3
- scanpy >= 1.9.1
- scikit-learn >= 1.2.1
- anndata >= 0.8.0
- h5py >= 3.8.0
- seaborn >= 0.11.0

**Note**: This version has been updated to support SciPy >= 1.15.3 for compatibility with modern Python environments and Python 3.12.

## Run SMOPCA

1. Prepare input data
   - SMOPCA accepts gene expression and protein/atac data matrices. Each modality of the data is preprocessed and normalized  separately. Initially, genes and proteins with zero counts were filtered out. Subsequently, the count matrix was normalized based on library size, followed by log-transformation and scaling to achieve unit variance and zero mean. ATAC reads are mapped to gene regions and the peak matrix is collapsed into a gene activity matrix, adhering to the established protocol from the Satija lab. The gene activity matrix was preprocessed and normalized using the same method as applied to mRNA data. Finally, we recommend to save the data into a hdf5 file.
   - Note that SMOPCA takes input matrices with columns corresponding to cells or spots.
2. Specify model hyperparameters and Model training
   - the dimensionality of the latent factors (default 20)
   - the kernel type (default matern kernel)
   - For the rest of the parameters, see more in tutorials.
3. Downstream analysis
   - Visualization
   - Clustering analysis
   - Differential expression analysis
   - GSEA
   - Other tasks

## Datasets

Sample datasets are provided in ./data folder. The rest of the datasets used in this study are available at https://doi.org/10.5281/zenodo.15187362
